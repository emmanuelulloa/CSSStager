<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>CSSStager</title>
	<meta name="viewport" content="initial-scale=1, maximum-scale=1">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Chango' rel='stylesheet' type='text/css'>
	<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
	<style type="text/css">
		/*Reset*/
		html, body, div, span, ul, li, p, h1, h2, h3{
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font: inherit;
			vertical-align: baseline;
		}
		body {
			line-height: 1;
		}
		ol, ul {
			list-style: none;
		}
		html, body {
			height: 100%;
		}
		body{
			font-family: 'Open Sans', Helvetica, Arial, sans-serif;
  			font-size: 14px;
  			transform-style: preserve-3d;
			-webkit-transform-style: preserve-3d;
			width: 100%;
			background-color: #eee;
			color: #555;
		}
		h1 {
			font-family: 'Chango', cursive;
			font-size: 200%;
			font-weight: bold;
			padding-top: 20px;
			margin-bottom: 10px;
		}
		p{
			font-size: 90%;
			margin-bottom: 20px;
		}
		a {color:#555;}
		.wrapper{
			width: 620px;
			padding-left: 16px;
			padding-right: 16px;
			margin: 0 auto;
		}
		.tagline {
			font-weight: bold;
			font-style: italic;
		}
		.instructions{
			line-height: 1.1;
		}
		.instructions li{
			display: block;
			margin-bottom: 10px;
		}
		._btn {
			background-color: gainsboro;
			color:grey;
			border-radius: 5px;
			text-decoration: none;
			padding-left: 3px;
			padding-bottom: 1px;
			padding-top: 1px;
			padding-right: 3px;
			box-shadow: 0px 0px 3px #999;
			transition: all 0.3s ease;
			-webkit-transition: all 0.3s ease;
			display: inline-block;
			margin-bottom: 3px;
			min-width: 120px;
			text-align: center;
		}
		._btn:hover, ._btn:focus{
			box-shadow: 0px 0px 3px #FFF;
			background-color: crimson;
			color:white;
		}
		/*Animations*/
/* n:titleChar*11 dy:100ms e:linear d:0.4s to:cc kf:class|kf:0 rot:-45 op:0 sc:5|kf:66.67 sc:0.5 */
@keyframes titleChar {
	0% {
		opacity : 0;
		transform: scale(5) rotate(-45deg) ;
	}
	66.67% {
		transform: scale(0.5) ;
	}
}
@-webkit-keyframes titleChar {
	0% {
		opacity : 0;
		-webkit-transform: scale(5) rotate(-45deg) ;
	}
	66.67% {
		-webkit-transform: scale(0.5) ;
	}
}
.logo {
	border-radius: 3px;
	margin-top: 5px;
	color: #555;
	padding: 8px;
	width: 250px;
}
.titleChar {
	transform-origin: center center;
	-webkit-transform-origin: center center;
	animation-name: titleChar;
	animation-duration: 0.4s;
	animation-timing-function: linear;
	animation-iteration-count: 1;
	animation-direction: normal;
	animation-fill-mode: both;
	animation-play-state: running;
	-webkit-animation-name: titleChar;
	-webkit-animation-duration: 0.4s;
	-webkit-animation-timing-function: linear;
	-webkit-animation-iteration-count: 1;
	-webkit-animation-direction: normal;
	-webkit-animation-fill-mode: both;
	-webkit-animation-play-state: running;
}
.titleChar:nth-child(1) {
	animation-delay: 0ms;
	-webkit-animation-delay: 0ms;
}
.titleChar:nth-child(2) {
	animation-delay: 100ms;
	-webkit-animation-delay: 100ms;
}
.titleChar:nth-child(3) {
	animation-delay: 200ms;
	-webkit-animation-delay: 200ms;
}
.titleChar:nth-child(4) {
	color:crimson;
	animation-delay: 300ms;
	-webkit-animation-delay: 300ms;
}
.titleChar:nth-child(5) {
	color:crimson;
	animation-delay: 400ms;
	-webkit-animation-delay: 400ms;
}
.titleChar:nth-child(6) {
	color:crimson;
	animation-delay: 500ms;
	-webkit-animation-delay: 500ms;
}
.titleChar:nth-child(7) {
	color:crimson;
	animation-delay: 600ms;
	-webkit-animation-delay: 600ms;
}
.titleChar:nth-child(8) {
	color:crimson;
	animation-delay: 700ms;
	-webkit-animation-delay: 700ms;
}
.titleChar:nth-child(9) {
	color:crimson;
	animation-delay: 800ms;
	-webkit-animation-delay: 800ms;
}
.titleChar:nth-child(10) {
	animation-delay: 900ms;
	-webkit-animation-delay: 900ms;
}
.titleChar:nth-child(11) {
	animation-delay: 1000ms;
	-webkit-animation-delay: 1000ms;
}
.layer {
	display: block;
	cursor: pointer;
	position: absolute;
	opacity: 1;
}
.selected{
	border:1px solid #00a8ff;
}
.numberInput{
	width: 45px;
}
.row{
	display: block;
}
.block-row{
	display: block;
	clear:both;
	float:left;
	width: 100%;
	margin-bottom: 5px;
}
.dropTarget {
	display: block;
	width: auto;
	height: 20px;
	margin: 5px 0 5px;
}
.to_md {
	display: inline-block;
	width: 100px;
	height: 100px;
	background-color: white;
	border: 1px solid #ccc;
	float: left;
	cursor:crosshair;
	position: relative;
}
.to_ctrl{
	display: inline-block;
	float: right;
}
.to_marker{
	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAPUlEQVQIW32OSQoAMAgDM/9/tCUtaheoh6BMjKKu2HrcT5EUEc1gMWsBgBxsKGiQsTYccOW8m9+blXZ/OwDWfiIFjeCl0wAAAABJRU5ErkJggg==) no-repeat;
	display: block;
	width: 7px;
	height: 7px;
	position: relative;
}
.footer{
	font-size: 85%;
	display: block;
	margin: 30px 0;
}
/*NEW DESIGN*/
.app{
	clear: left;
	float: left;
	display: block;
	width: 100%;
	height: 100%;
	overflow: auto;
}
.shell {
	float:left;
	display: block;
	width: 100%;
	height: 100%;
	position: relative;
	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAHElEQVQIW2M8f/78fwYcgBEkaWhoyIhNftBJAgDsiht0x6jrLgAAAABJRU5ErkJggg==) repeat;
}
.tools{
	float:left;
	display: block;
	width: 33%;
	padding-left: 1%;
	padding-right: 1%;
	height: 100%;
	overflow: auto;
	background: #eee;
}
.stage-container{
	float:left;
	display: block;
	width: 65%;
	height: 100%;
	overflow: auto;
	-webkit-box-shadow: inset 6px 0px 5px 0px rgba(0,0,0,0.2);
	-moz-box-shadow: inset 6px 0px 5px 0px rgba(0,0,0,0.2);
	box-shadow: inset 6px 0px 5px 0px rgba(0,0,0,0.2);
	position: relative;
}
.stage {
	background-color: white;
	border: 1px solid #555;
	display: block;
	margin: 0 auto;
	vertical-align: middle;
	width: 550px;
	height: 400px;
	box-shadow: 0px 0px 3px #999;
	position: inherit;
	margin-top: 10%;
	margin-bottom: 10%;
}
		.output{
			font-family: "Courier New", Courier, monospace;
			width: 97%;
			color:#555;
			margin: 0 auto;
			text-align: left;
			padding: 5px;
			border: 1px solid #555;
			display: inline-block;
			white-space: pre;
  			word-wrap: normal;
			overflow: auto;
		}
		.controls {
			border-radius: 10px;
			font-size: 85%;
			width: 96%;
			padding: 10px;
			margin: 0 auto 1%;
			color:gray;
			font-weight: bold;
			line-height: 2;
			border: 1px solid #ddd;
			box-shadow: 0px 0px 3px #999;
			/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#ffffff+0,f1f1f1+50,e1e1e1+51,f6f6f6+100;White+Gloss+%231 */
			background: #ffffff; /* Old browsers */
			background: -moz-linear-gradient(top,  #ffffff 0%, #f1f1f1 50%, #e1e1e1 51%, #f6f6f6 100%); /* FF3.6+ */
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(50%,#f1f1f1), color-stop(51%,#e1e1e1), color-stop(100%,#f6f6f6)); /* Chrome,Safari4+ */
			background: -webkit-linear-gradient(top,  #ffffff 0%,#f1f1f1 50%,#e1e1e1 51%,#f6f6f6 100%); /* Chrome10+,Safari5.1+ */
			background: -o-linear-gradient(top,  #ffffff 0%,#f1f1f1 50%,#e1e1e1 51%,#f6f6f6 100%); /* Opera 11.10+ */
			background: -ms-linear-gradient(top,  #ffffff 0%,#f1f1f1 50%,#e1e1e1 51%,#f6f6f6 100%); /* IE10+ */
			background: linear-gradient(to bottom,  #ffffff 0%,#f1f1f1 50%,#e1e1e1 51%,#f6f6f6 100%); /* W3C */
		}
		.document-properties{
			display: block;
			height: 180px;
		}
		.elements-properties{
			display: none;
			height: 375px;
		}
		.hideOverflow {
			overflow: hidden;
		}
		.controls .left{
			width: 49%;
			padding-right: 1%;
			float: left;
			display: block;
			text-align: right;
			float: left;

		}
		.controls .right{
			width: 49%;
			padding-left: 1%;
			float: right;
			display: block;
			text-align: left;
			float: right;
		}
		.controls h2 {
			font-variant: small-caps;
			padding: 0;
			font-size: 100%;
			font-weight: bold;
			display: block;
			width: 100%;
			text-align: justify;
		}
		.controls strong{
			color: #555;
			font-weight: bolder;
		}
		.controls .lbl {
			display: inline-block;
			width: 60px;
		}
		/* PLUG-INS */
		.overlay{
			background-color: rgba(0,0,0,0.7);
			position: fixed;
			display: none;
			width: 100%;
			height: 100%;
			z-index: 999;
			overflow: auto;
		}
		.overlay .close{
			background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAQklEQVQYV5WQQQoAQAgC9f+PdulQVHRwuxQ5oEVJAgCSjL6r9BwueGgBXPDelV0Xun1GGrk23HP/g5a1dYz9HvfhD17FP/tzvfJcAAAAAElFTkSuQmCC);
			background-repeat: no-repeat;
			background-position: 5px 5px;
			border-radius: 10px;
			width: 20px;
			height: 20px;
			text-align: center;
			color: #FFF;
			background-color: #666;
			font-weight: bold;
			font-size: 30px;
			position: absolute;
			display: block;
			top: 10px;
			right: 10px;
			cursor: pointer;
		}
		.overlay textarea{
			width: 98%;
		}
		.overlay .row{
			margin-bottom: 5px;
		}
		.overlay .lbl{
			width: 75px;
			display: inline-block;
		}
		.overlay hr{
			width: 80%;
			text-align: center;
			border: 1px dashed #CCC;
		}
		.overlay .create_btn{
			color: white;
			background-color: #666;
			border-radius: 5px;
			font-size: 14px;
			font-weight: bold;
			text-decoration: none;
			padding: 8px;
			margin: 3px;
			display: inline-block;
			transition: background-color 0.5s;
			-webkit-transition: background-color 0.5s;
		}
		.overlay .bottom{
			clear: both;
			width: 100%;
			padding: 0;
			margin: 0;
		}
		/* tranCiSSioner */
		.tranCiSSioner_tools {
			position: relative;
			background-color: #FFF;
			border-radius: 15px;
			padding: 1%;
			width: 70%;
			height: 85%;
			margin: 2% auto;
			display: none;
		}
		.tranCiSSioner_tools .blueText{
			color: dodgerblue;
		}
		.tranCiSSioner_tools .close{
			background-color: dodgerblue;
		}
		.tranCiSSioner_tools .col1{
			width:33%;
			padding: 0;
			margin: 0;
			float: left;
			display: inline-block;
		}
		.tranCiSSioner_tools .col2{
			width:33%;
			padding: 0;
			margin: 0;
			float: left;
			display: inline-block;
		}
		.tranCiSSioner_tools .col3{
			width:33%;
			padding: 0;
			margin: 0;
			float: left;
			display: inline-block;
		}
		.position_scene{
			margin: 8px 0px;
		}
		.position_scene_tbl{
			border: 1px solid #999;
			width: 150px;
			text-align: center;
		}
		.tranCiSSioner_tools .create_btn{
			background-color: dodgerblue;
		}
		.tranCiSSioner_tools .create_btn:hover{
			background-color: skyblue;
		}
		/* spriteSlicer */
		.spriteSlicer_tools {
			position: relative;
			background-color: #FFF;
			border-radius: 15px;
			padding: 1% 1% 2% 1%;
			width: 70%;
			min-height: 85%;
			height: auto;
			margin: 2% auto;
			display: none;
			overflow: auto;
		}
		.spriteSlicer_tools .greenText{
			color: mediumseagreen;
		}
		.spriteSlicer_tools .close{
			background-color: mediumseagreen;
		}
		.spriteSlicer_tools .col1{
			width:auto;
			height: 100%;
			padding: 0;
			margin: 0;
			float: left;
			display: inline-block;
			overflow: auto;
		}
		.spriteSlicer_tools .col2{
			padding: 0;
			margin: 0 0 0 20px;
			float: left;
			display: inline-block;
		}
		.spriteSlicer_tools .create_btn{
			background-color: mediumseagreen;
		}
		.spriteSlicer_tools .create_btn:hover{
			background-color: seagreen;
		}
		#ss_code_txt {
			width: 95%;
			height: 50%;
		}
		#ss_cuts_txt {
			border: none;
			outline: none;
			font-weight: bold;
			font-size: 12px;
			color: seagreen;
			width: 95%;
			border: 1px dotted mediumseagreen;
			border-radius: 8px;
			padding: 3px;
			margin: 3px;
		}
		.ss_container {
			border: 1px solid #999;
			background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAJ0lEQVQYV2M8c+bMfwYkYGxsjMxlYKSDgv///6O44ezZs6huoL0CAHomKYWYrWVpAAAAAElFTkSuQmCC) repeat;
			width: 96%;
			margin-right: 2%;
			margin-left: 2%;
			margin-bottom: 0;
			margin-left: 0;
			padding: 0;
			display: block;
			cursor:row-resize;
			position: relative;
			overflow: auto;
		}
		.ss_image {
			background-color: transparent;
			background-repeat: no-repeat;
		}
		.ss_guide {
			width: 100%;
			height: 12px;
			display: block;
			position: absolute;
			border-top: 1px dashed limegreen;
			margin: 0;
			padding: 0;
			top: 0px;
			left: 0px;
			font-size: 10px;
			text-align: center;
			color: white;
			background-color: rgba(0,0,0,0.3);
			font-family: courier, mono;
		}
	</style>
</head>
<body>
	<div class="app">
	<div class="overlay">
		<div class="tranCiSSioner_tools">
			<h1>tran<span class="blueText">C</span>i<span class="blueText">SS</span>ioner</h1>
			<div id="tranCiSSioner_close" class="close"></div>
			<div class="col1">
				<span class="row"><label for="" class="lbl">Scene <strong>IN</strong>:</label> <input id="scene_in_txt" type="number" min="1" step="1" value="1" class='numberInput'></span>
				<hr />
				<span class="row"><label for="" class="lbl">Opacity:</label> <input type="number" name="" id="opacity_in_txt" value="0" class='numberInput'></span>
				<div class="position_scene">
					<span class="row"><label for="">Entrance position:</label></span>
					<table class="position_scene_tbl">
						<tr>
							<td><input type="radio" name="scene_in_rb" id="tl_in_rb" value="tl" /></td>
							<td><input type="radio" name="scene_in_rb" id="top_in_rb" value="top" /></td>
							<td><input type="radio" name="scene_in_rb" id="tr_in_rb" value="tr" /></td>
						</tr>
						<tr>
							<td><input type="radio" name="scene_in_rb" id="left_rb" value="left" /></td>
							<td><input type="radio" name="scene_in_rb" id="none_in_rb" value="none" checked /></td>
							<td><input type="radio" name="scene_in_rb" id="right_rb" value="right" /></td>
						</tr>
						<tr>
							<td><input type="radio" name="scene_in_rb" id="bl_in_rb" value="bl" /></td>
							<td><input type="radio" name="scene_in_rb" id="bottom_in_rb" value="bottom" /></td>
							<td><input type="radio" name="scene_in_rb" id="br_in_rb" value="br"></td>
						</tr>
					</table>
				</div>
				<span class="row"><label for="" class="lbl">Offset:</label><input id="offset_in_txt" type="number" value="10" class='numberInput' />px</span>
				<span class="row"><label for="" class="lbl">Transform:</label><input type="text" name="" id="matrix_in_txt"></span>
				<hr />
				<span class="row"><label for="" class="lbl">Duration:</label><input id="duration_in_txt" type="number" value="0.5" class='numberInput'>s</span>
				<span class="row"><label for="" class="lbl">Ease:</label>
					<select id="ease_in_sl">
						<option value="ease">ease</option>
						<option value="ease-out" selected >ease-out</option>
						<option value="ease-in">ease-in</option>
						<option value="ease-in-out">ease-in-out</option>
						<option value="linear">linear</option>
						<option value="cubic-bezier(.65, 1.95, .03, .32)">bounce</option>
						<option value="cubic-bezier(0.47, 2.02, 0.31, -0.36)">elastic</option>
						<option value="cubic-bezier(.25,2,.75,.5)">spring</option>
						<option value="cubic-bezier(.175, .885,.32,1.275)">swing</option>
						<option value="cubic-bezier(.755,.05,.855,.06)">snap</option>
						<option value="cubic-bezier(.2,1,.9,-0.5)">hesitate</option>
						<option value="cubic-bezier(.5,0,.8,.15)">anticipate</option>
						<option value="cubic-bezier(.41,.41,.35,1.2)">overshoot</option>
						<option value="cubic-bezier(.45,-0.67,.53,1.63)">anticipate overshoot</option>
						<option value="cubic-bezier(0.4,0,1,1)">fast out</option>
						<option value="cubic-bezier(0,0,0.2,1)">slow in</option>
						<option value="cubic-bezier(0.4,0,0.2,1)">fast out - slow in</option>
						<optgroup label='Penner easings:'>
							<option value="cubic-bezier(.55,.055,.675,.19)">easeInCubic</option>
							<option value="cubic-bezier(.215,.61,.355,1)">easeOutCubic</option>
							<option value="cubic-bezier(.645,.045,.355,1)">easeInOutCubic</option>
							<option value="cubic-bezier(.6,.04,.98,.335)">easeInCirc</option>
							<option value="cubic-bezier(.075,.82,.165,1)">easeOutCirc</option>
							<option value="cubic-bezier(.785,.135,.15,.86)">easeInOutCirc</option>
							<option value="cubic-bezier(.95,.05,.795,.035)">easeInExpo</option>
							<option value="cubic-bezier(.19,1,.22,1)">easeOutExpo</option>
							<option value="cubic-bezier(1,0,0,1)">easeInOutExpo</option>
							<option value="cubic-bezier(.55,.085,.68,.53)">easeInQuad</option>
							<option value="cubic-bezier(.25,.46,.45,.94)">easeOutQuad</option>
							<option value="cubic-bezier(.455,.03,.515,.955)">easeInOutQuad</option>
							<option value="cubic-bezier(.895,.03,.685,.22)">easeInQuart</option>
							<option value="cubic-bezier(.165,.84,.44,1)">easeOutQuart</option>
							<option value="cubic-bezier(.77,0,.175,1)">easeInOutQuart</option>
							<option value="cubic-bezier(.755,.05,.855,.06)">easeInQuint</option>
							<option value="cubic-bezier(.23,1,.32,1)">easeOutQuint</option>
							<option value="cubic-bezier(.86,0,.07,1)">easeInOutQuint</option>
							<option value="cubic-bezier(.47,0,.745,.715)">easeInSine</option>
							<option value="cubic-bezier(.39,.575,.565,1)">easeOutSine</option>
							<option value="cubic-bezier(.445,.05,.55,.95)">easeInOutSine</option>
							<option value="cubic-bezier(.6,-.28,.735,.045)">easeInBack</option>
							<option value="cubic-bezier(.175, .885,.32,1.275)">easeOutBack</option>
							<option value="cubic-bezier(.68,-.55,.265,1.55)">easeInOutBack</option>
						</optgroup>
					</select>
				</span>
				<span class="row"><label for="" class="lbl">Delay:</label><input id="delay_in_txt" type="number" value="0.5" class='numberInput'>s</span>
			</div>
			<div class="col2">
				<!-- ELEMENT PROPERTIES & ANIMATIONS -->
				<span class="row">Element class: <input id="scene_element_txt" type="text" value=".myDiv" /></span>
				<span class="row"><label for="left_scene_txt">X:</label> <input id="left_scene_txt" type="number" size="4" value='0' class="numberInput" /><label for="top_scene_txt"> Y:</label> <input id="top_scene_txt" type="number" size="4" value='0' class="numberInput" /></span>
				<!--span class="row"><input type="checkbox" name="use_animation_ck" id="use_animation_ck"><label for="use_animation_ck"> Use attention getter:</label></span>
				<span class="row">
					<select name="use_animation_sl" id="use_animation_sl">
						<option value="">Horizontal</option>
						<option value="">Vertical</option>
						<option value="">Scale</option>
						<option value="">Grow</option>
						<option value="">Slow rotation</option>
						<option value="">Buzz</option>
						<option value="">Shake</option>
						<option value="">Hard bounce</option>
						<option value="">Cartoon bounce</option>
						<option value="">Hang</option>
						<option value="">Float</option>
						<option value="">Flash</option>
					</select>
				</span-->
			</div>
			<div class="col3">
				<span class="row"><label for="" class="lbl">Scene <strong>OUT</strong>:</label> <input id="scene_out_txt" type="number" min="1" step="1" value="2" class='numberInput'></span>
				<hr />
				<span class="row"><label for="" class="lbl">Opacity:</label> <input type="number" name="" id="opacity_out_txt" value="0" class='numberInput'></span>
				<div class="position_scene">
					<span class="row"><label for="">Exit position:</label></span>
					<table class="position_scene_tbl">
						<tr>
							<td><input type="radio" name="scene_out_rb" id="tl_out_rb" value="tl" /></td>
							<td><input type="radio" name="scene_out_rb" id="top_out_rb" value="top" /></td>
							<td><input type="radio" name="scene_out_rb" id="tr_out_rb" value="tr" /></td>
						</tr>
						<tr>
							<td><input type="radio" name="scene_out_rb" id="left_rb" value="left" /></td>
							<td><input type="radio" name="scene_out_rb" id="none_out_rb" value="none" checked /></td>
							<td><input type="radio" name="scene_out_rb" id="right_rb" value="right" /></td>
						</tr>
						<tr>
							<td><input type="radio" name="scene_out_rb" id="bl_out_rb" value="bl" /></td>
							<td><input type="radio" name="scene_out_rb" id="bottom_out_rb" value="bottom" /></td>
							<td><input type="radio" name="scene_out_rb" id="br_out_rb" value="br"></td>
						</tr>
					</table>
				</div>
				<span class="row"><label for="" class="lbl">Offset:</label><input id="offset_out_txt" type="number" value="10" class='numberInput' />px</span>
				<span class="row"><label for="" class="lbl">Transform:</label><input type="text" name="" id="matrix_out_txt"></span>
				<hr />
				<span class="row"><label for="" class="lbl">Duration:</label><input id="duration_out_txt" type="number" value="0.3" class='numberInput'>s</span>
				<span class="row"><label for="" class="lbl">Ease:</label>
					<select id="ease_out_sl">
						<option value="ease">ease</option>
						<option value="ease-out">ease-out</option>
						<option value="ease-in" selected >ease-in</option>
						<option value="ease-in-out">ease-in-out</option>
						<option value="linear">linear</option>
						<option value="cubic-bezier(.65, 1.95, .03, .32)">bounce</option>
						<option value="cubic-bezier(0.47, 2.02, 0.31, -0.36)">elastic</option>
						<option value="cubic-bezier(.25,2,.75,.5)">spring</option>
						<option value="cubic-bezier(.175, .885,.32,1.275)">swing</option>
						<option value="cubic-bezier(.755,.05,.855,.06)">snap</option>
						<option value="cubic-bezier(.2,1,.9,-0.5)">hesitate</option>
						<option value="cubic-bezier(.5,0,.8,.15)">anticipate</option>
						<option value="cubic-bezier(.41,.41,.35,1.2)">overshoot</option>
						<option value="cubic-bezier(.45,-0.67,.53,1.63)">anticipate overshoot</option>
						<option value="cubic-bezier(0.4,0,1,1)">fast out</option>
						<option value="cubic-bezier(0,0,0.2,1)">slow in</option>
						<option value="cubic-bezier(0.4,0,0.2,1)">fast out - slow in</option>
						<optgroup label='Penner easings:'>
							<option value="cubic-bezier(.55,.055,.675,.19)">easeInCubic</option>
							<option value="cubic-bezier(.215,.61,.355,1)">easeOutCubic</option>
							<option value="cubic-bezier(.645,.045,.355,1)">easeInOutCubic</option>
							<option value="cubic-bezier(.6,.04,.98,.335)">easeInCirc</option>
							<option value="cubic-bezier(.075,.82,.165,1)">easeOutCirc</option>
							<option value="cubic-bezier(.785,.135,.15,.86)">easeInOutCirc</option>
							<option value="cubic-bezier(.95,.05,.795,.035)">easeInExpo</option>
							<option value="cubic-bezier(.19,1,.22,1)">easeOutExpo</option>
							<option value="cubic-bezier(1,0,0,1)">easeInOutExpo</option>
							<option value="cubic-bezier(.55,.085,.68,.53)">easeInQuad</option>
							<option value="cubic-bezier(.25,.46,.45,.94)">easeOutQuad</option>
							<option value="cubic-bezier(.455,.03,.515,.955)">easeInOutQuad</option>
							<option value="cubic-bezier(.895,.03,.685,.22)">easeInQuart</option>
							<option value="cubic-bezier(.165,.84,.44,1)">easeOutQuart</option>
							<option value="cubic-bezier(.77,0,.175,1)">easeInOutQuart</option>
							<option value="cubic-bezier(.755,.05,.855,.06)">easeInQuint</option>
							<option value="cubic-bezier(.23,1,.32,1)">easeOutQuint</option>
							<option value="cubic-bezier(.86,0,.07,1)">easeInOutQuint</option>
							<option value="cubic-bezier(.47,0,.745,.715)">easeInSine</option>
							<option value="cubic-bezier(.39,.575,.565,1)">easeOutSine</option>
							<option value="cubic-bezier(.445,.05,.55,.95)">easeInOutSine</option>
							<option value="cubic-bezier(.6,-.28,.735,.045)">easeInBack</option>
							<option value="cubic-bezier(.175, .885,.32,1.275)">easeOutBack</option>
							<option value="cubic-bezier(.68,-.55,.265,1.55)">easeInOutBack</option>
						</optgroup>
					</select>
				</span>
				<span class="row"><label for="" class="lbl">Delay:</label><input id="delay_out_txt" type="number" value="0" class='numberInput'>s</span>
			</div>
			<div class="bottom">
				<a href="#" id="tranCiSSioner_create_btn" class="create_btn">Create CSS</a>
				<textarea name="" id="transition_css_txt" cols="30" rows="10"></textarea>
			<ul>
				<li><a href="https://www.google.com/design/spec/animation/authentic-motion.html#authentic-motion-mass-weight" target="_blank">Animation guidelines by Google</a></li>
				<li><a href="https://developers.google.com/web/fundamentals/look-and-feel/animations/?hl=en" target="_blank">Web Fundamentals: Animations by Google</a></li>
			</ul>				
			</div>

		</div>
		<div class="spriteSlicer_tools">
			<h1>Sprite<span class="greenText">Slicer<span class="greenText"></h1>
			<p>Hover the image, click where you want to cut.</p>
			<div id="spriteSlicer_close" class="close"></div>
			<div class="col1">
				<div class="ss_container">
					<div class="ss_image"></div>
					<div class="ss_guide">
						y:0px
					</div>
				</div>
			</div>
			<div class="col2">
				<span class="row">Vertical cut positions: <input id="ss_cuts_txt" value="" type="text" /></span>
				<span class="row"><input type="checkbox" name="" id="ss_layered_ck"><label for="ss_layered_ck">Layered (elements will have the same 'y' position)</label></span>
				<hr />
				<span class="row"><input type="checkbox" name="" id="ss_transition_ck" checked ><label for="ss_transition_ck">Use opacity transitions:</label></span>
				<span class="row">Scene IN <input type="number" id="ss_scene_in_txt" value="1" class="numberInput">| Scene OUT <input type="number" id="ss_scene_out_txt" value="2" class="numberInput"></span>
				<span class="row">Staggered delay</span>
				<span class="row">IN: <input type="number" id="ss_delay_in" step="0.1" min="0" value="0.5" class="numberInput"/>s | OUT:<input type="number" id="ss_delay_out" step="0.1" min="0" value="0.3" class="numberInput"/>s</span>
				<span class="row"><a href="#" id="spriteSplicer_create_btn" class="create_btn">Create CSS</a></span>
				<span class="row"><textarea id="ss_code_txt" cols="50" rows="15"></textarea></span>
				<span class="row">Apply slice to current element:<input type="number" id="ss_slices" min="1" step="1" max="1" value="1" /> <a href="#" id="ss_apply" class="_btn">&lt; apply</a></span>
				<hr />
				<span class="row"><a href="#" id="ss_reset" class="_btn">reset</a></span>
			</div>
		</div>
	</div>
	<div class="shell">
		<div class="tools">
			<h1 class="logo"><span class="titleChar">C</span><span class="titleChar">S</span><span class="titleChar">S</span><span class="titleChar">S</span><span class="titleChar">t</span><span class="titleChar">a</span><span class="titleChar">g</span><span class="titleChar">e</span><span class="titleChar">r</span></h1>
			<p class='tagline'>Set DOM elements as you need them before starting your animations.</p>
			<div class="controls document-properties">
				<h2>Document Properties</h2>
				<span class="row">Background/Guide Image: <input type='file' accept='image/*' id='guide_fl' class='_btn dropTarget' /></span>
				<span class="row">Banner size:
					<select name="size_sl" id="size_sl">
						<optgroup label='Select size:'>
						<option value="500x400">500x400 New Document</option>
						<option value="300x250">300x250 Medium Rectangle</option>
						<option value="728x90">728x90 Leaderboard Banner</option>
						<option value="160x600">160x600 Wide Skyscraper</option>
						<option value="120x600">120x600 Skyscraper</option>
						<option value="940x400">940x400 Website Slider</option>
						<option value="720x300">720x300 Pop-Under</option>
						<option value="300x600">300x600 Half Page Ad</option>
						<option value="250x250">250x250 Square Popup</option>
						<option value="428x60">428x60 Full Banner</option>
						<option value="336x280">336x280 Square</option>
						<option value="120x240">120x240 Vertical Banner</option>
						<option value="240x400">240x400 Vertical Rectangle</option>
						<option value="234x60">234x60 Half Banner</option>
						<option value="180x150">180x150 Rectangle</option>
						<option value="125x125">125x125 Square Button</option>
						<option value="120x90">120x90 Button</option>
						<option value="120x60">120x60 Button</option>
						<option value="88x31">88x31 Micro Bar</option>
						</optgroup>
					</select>	
				</span>
				<span class="row">
					Custom size: <input type="number" size="4" value='550' id='width_txt' class='numberInput' /> x <input type="text" value='400' id='height_txt' class='numberInput' />
				</span>
				<span class="row">Background Color: <input id="bgColor_txt" type="text" value="#FFF" class='numberInput' /> Border Color: <input id="borderColor_txt" type="text" value="#666" class='numberInput' /></span>
				<span class="row"><input id="overflow_ck" type="checkbox" /><label for="overflow_ck">Hide off-stage objects.</label></span>
			</div>
			<div class="controls elements-properties">
				<div class="left">
					<h2 id="element_lbl">Element: ?</h2>
					<span class="row"><strong>Element size and position:</strong></span>
					<span class="row"><label for="left_txt">X:</label> <input id="left_txt" type="number" size="4" value='0' class="numberInput" /><label for="top_txt"> Y:</label> <input id="top_txt" type="number" size="4" value='0' class="numberInput" /></span>
					<span class="row">Element alignment: 
						<select name="align_sl" id="align_sl">
							<option value="top">top</option>
							<option value="bottom">bottom</option>
							<option value="left">left</option>
							<option value="right">right</option>
							<option value="center">center</option>
							<option value="middle">middle</option>
						</select>
					</span>
					<span class="row"><label for="w_txt">W:</label> <input id="w_txt" type="number" size="4" value='0' min="0" class="numberInput" /><label for="h_txt"> H:</label> <input id="h_txt" type="number" size="4" value='0' min="0" class="numberInput" /></span>
					<span class="row">Scale w/o transform: <input id="scale_txt" type="number" min="0" value='100' class="numberInput">%</span>
					<span class="row"><label for="opacity_rng">Opacity:</label> <input id="opacity_rng" type="range" value='100' min='0' max='100' /></span>
					<span class="row"><strong>Element background info:</strong></span>
					<span class="row"><label for="bgx_txt">X:</label> <input id="bgx_txt" type="number" size="4" value='0' class="numberInput" /><label for="bgy_txt"> Y:</label> <input id="bgy_txt" type="number" size="4" value='0' class="numberInput" /></span>
					<span class="row"><label for="bgw_txt">W:</label> <input id="bgw_txt" type="number" size="4" value='0' min="0" class="numberInput" /><label for="bgh_txt"> H:</label> <input id="bgh_txt" type="number" size="4" value='0' min="0" class="numberInput" /></span>
					<span class="row"><a href="#" id="trancissioner_btn" class="_btn">Launch tranCiSSioner</a></span>
					<span class="row"><a href="#" id="spriteslicer_btn" class="_btn">Launch SpriteSlicer</a></span>
				</div>
				<div class="right">
					<h2>Transform:</h2>
					<span class="row"><label for="sc_rng" class="lbl">Scale:</label> <input id="sc_rng" type="range" value='100' min='0' max='200' /></span>
					<span class="row"><label for="rot_rng" class="lbl">Rotation:</label> <input id="rot_rng" type="range" value='0' min='-180' max='180' /></span>
					<span class="row"><label for="sk_rng" class="lbl">Skew:</label> <input id="sk_rng" type="range" value='0' min='-60' max='60' /></span>
					<span class="row"><label for="rot_txt">Rotation: </label><input type="number" size="4" value='0' class="numberInput" id="rot_txt"> deg</span>
					<span class="row"><label for="scx_txt">Scale X:</label> <input id="scx_txt" type="number" size="4" value='1' class="numberInput" /><label for="scy_txt"> Scale Y:</label> <input id="scy_txt" type="number" size="4" value='1' class="numberInput" /></span>
					<span class="row"><label for="x_txt">Translate X:</label> <input id="x_txt" type="number" size="4" value='0' class="numberInput" />px</span>
					<span class="row"><label for="y_txt">Translate Y:</label> <input id="y_txt" type="number" size="4" value='0' class="numberInput" />px</span>
					<div class="block-row">
						<h2>Transform Origin</h2>
						<div class="to_md">
							<div class="to_marker"></div>
						</div>
						<div class="to_ctrl">
						<span class="row"><label for="tox_txt">X:</label> <input id="tox_txt" type="number" size="4" value='0' class="numberInput" /> px</span>
						<span class="row"><label for="toy_txt">Y:</label> <input id="toy_txt" type="number" size="4" value='0' class="numberInput" /> px</span>	
						</div>
					</div>
					<span class="row"><a href="#" id="reset_btn" class="_btn">RESET</a></span>
				</div>
			</div>
		<p>Get your code (html/css):</p>
		<p><input id="onlycss_ck" type="checkbox" checked />Only CSS</p>
		<div class="row">
			<textarea name="htmlOutput" id="htmlOutput_txt" class="output" cols="15" rows="10"></textarea>
		</div>
		<p class="footer">&copy;2015 Emmanuel Ulloa</p>
		</div>
		<div class="stage-container">
			<div id="stage" class="stage"></div>
		</div>
	</div>
	</div>
<script type='text/javascript'>
$(function(){
	//http://www.html5rocks.com/en/tutorials/file/dndfiles/
	//http://blog.teamtreehouse.com/reading-files-using-the-html5-filereader-api
	//http://keithclark.co.uk/articles/calculating-element-vertex-data-from-css-transforms/
	var css = {
		container : {width:550,height:400,bgColor:'#FFF',borderColor:'#666'},
		background : {file:null},
		layers : [],
		images : {},
		imgSizes : {},
		layerTransforms : {},
		currentLayer : null
	}
	var $stage = $('#stage'),
		$size_sl = $('#size_sl'),
		$width_txt = $('#width_txt'),
		$height_txt = $('#height_txt'),
		$guide_fl = $('#guide_fl');
	//FUNCTIONS
	function $id(i){
		return document.getElementById(i);
	}
	var depth = 0;
	function getNextHighestDepth(){
		return ++depth;
	}
	var counter = 0, filesMax = 0;
	var I_LAYER = '_iLayer';
	var O_LAYER = '_oLayer';
	function createLayer(files){
		filesMax = files.length;
		for(var i=0; i < files.length; i++){
			var file = files[i];
			if (file.type.match(/image.*/)){
				var reader = new FileReader();
				reader.onload = (function(file){
					return function(evt){
						++counter;
						var img = new Image();
						img.src = evt.target.result;
						var name = file.name.split('.')[0];
						css.images[name] = file.name;
						var draggableLayer = document.createElement('div');
						var opacityLayer = document.createElement('div');
						var imageLayer = document.createElement('div');
						//for events this is the layer you want to target, it also holds the className = layer and the selected border. This layer is the one to use to obtain left and top values
						draggableLayer.id = name;
						draggableLayer.className = 'layer';
						draggableLayer.style.left = '0px';
						draggableLayer.style.top = '0px';
						//this layer holds opacity, transform-origin and transformations
						opacityLayer.id = name + O_LAYER;
						//this layer holds image-background, image-position, width, height
						imageLayer.id = name + I_LAYER;
						imageLayer.style.backgroundImage = 'url(' + img.src + ')';
						imageLayer.style.backgroundRepeat = 'no-repeat';
						imageLayer.style.backgroundPosition = '0px 0px';
						imageLayer.style.backgroundSize = img.width + 'px ' + img.height + 'px';
						imageLayer.style.width = img.width + 'px';
						imageLayer.style.height = img.height + 'px';
						css.imgSizes[name] = {width:img.width,height:img.height,scale:1};
						delete img;
						//Let's assemble
						opacityLayer.appendChild(imageLayer);
						draggableLayer.appendChild(opacityLayer);
						$stage.append(draggableLayer);
						var $draggableLayer = $(draggableLayer);
						$draggableLayer.draggable({
							start:onDragStart
						},{
							stop:onDragStop
						});
						$draggableLayer.click(function(evt){
							var layer = getLayer(evt.target.id);
							if(layer === this){
								if($(layer).is('.ui-draggable-dragging')){
									return;
								}
								selectLayer(layer);
							}
							return;
						});
						css.layerTransforms[name] = {};
						css.layers.push(draggableLayer);
						if(counter == filesMax){
							selectLayer(getLayer(name));
							openTools();
						}
					}
				})(file);
				reader.readAsDataURL(file);
			}	
		}
	}
	function getLayer(id){
		if(id.indexOf(I_LAYER) !== -1){
			return $id(id.replace(I_LAYER, ''));
		}else if(id.indexOf(O_LAYER) !== -1){
			return $id(id.replace(O_LAYER, ''));
		}
		return $id(id);
	}
	function fixDecimal(val){
		return Math.round(val*1000)/1000;
	}
	function openTools(){
		$('.controls').slideDown();
	}
	function changeSize(w,h){
		css.container.width = w;
		css.container.height = h;
		$width_txt.val(css.container.width);
		$height_txt.val(css.container.height);
		$stage.css('width', css.container.width + 'px').css('height', css.container.height + 'px');
	}
	function changeColors(bg,col){
		css.container.bgColor = bg;
		css.container.borderColor = col;
		$stage.css('background-color', bg).css('border-color',col);
		$('.to_md').css('background-color', bg);
	}
	function setLayerBorder($layer, op){
		$layer.css('border', '1px dashed rgba(255, 0, 255, ' + (1 - op) + ')');
	}
	function deselect(){
		$('.layer').each(function(i,element){
			$(element).removeClass('selected');
		});
	}
	function selectLayer(el){
		deselect();
		css.currentLayer = $(el);
		css.currentLayer.addClass('selected');
		css.currentLayer.css('z-index',getNextHighestDepth());
		updateHUD(css.currentLayer);
	}
	function updateHUD($layer){
		var name = $layer.attr('id');
		var $iLayer = $('#' + name + I_LAYER);
		var $oLayer = $('#' + name + O_LAYER);
		var layerTransform = css.layerTransforms[name];
		$('#element_lbl').text('Element: ' + $layer.attr('id') + ' ' + $iLayer.css('width') + ' x ' + $iLayer.css('height'));
		$('#left_txt').val($layer.css('left').replace('px',''));
		$('#top_txt').val($layer.css('top').replace('px',''));
		var op = parseFloat($iLayer.css('opacity'));
		$('#opacity_rng').val(Math.round(op * 100) + '');
		setLayerBorder($oLayer,op);
		$('#w_txt').val($iLayer.css('width').replace('px',''));
		$('#h_txt').val($iLayer.css('height').replace('px',''));
		var bgsize = $iLayer.css('background-size').split(' ');
		$('#bgw_txt').val(bgsize[0].replace('px',''));
		$('#bgh_txt').val(bgsize[1].replace('px',''));
		var bgpos = $iLayer.css('background-position').split(' ');
		$('#bgx_txt').val(bgpos[0].replace('px',''));
		$('#bgy_txt').val(bgpos[1].replace('px',''));
		//Transform Origin thumbnail
		var w = parseFloat($iLayer.css('width')), h = parseFloat($iLayer.css('height'));
		var b = Math.max(w,h), ratio = 1, bgSize = {width:100,height:100};
		if(b == w){
			ratio = (100/w);
			bgSize.height = ratio * h;
		}else{
			ratio = (100/h);
			bgSize.width = ratio * w;
		}
		$('.to_md').css('background-image', $iLayer.css('background-image'));
		$('.to_md').css('background-repeat', 'no-repeat');
		$('.to_md').css('background-size', bgSize.width + 'px ' + bgSize.height + 'px');
		var to = $iLayer.css('transform-origin').split(' ');
		var tox = parseFloat(to[0]);
		var toy = parseFloat(to[1]);
		$('#tox_txt').val(tox);
		$('#toy_txt').val(toy);
		var rx = tox/w;
		var ry = toy/h;
		$('.to_marker').css('left',Math.round(rx * bgSize.width) + 'px');
		$('.to_marker').css('top',Math.round(ry * bgSize.height) + 'px');
		//TRANSFORMS
		if(layerTransform.scale){
			if(layerTransform.scale.x == layerTransform.scale.y){
				$('#sc_rng').val((layerTransform.scale.x * 100));
			}
			$('#scx_txt').val(parseFloat(layerTransform.scale.x));
			$('#scy_txt').val(parseFloat(layerTransform.scale.y));
		}
		if(layerTransform.rotate){
			$('#rot_rng').val(layerTransform.rotate);
			$('#rot_txt').val(layerTransform.rotate);
		}
		if(layerTransform.skew){
			$('#sk_rng').val(layerTransform.skew);
		}
		$('#htmlOutput_txt').val(createHTML());
	}
	function onHUDEvents(){
		$('.to_md').click(function(evt){
			if(evt.target === this){
				evt = evt || window.event;
			    var target = evt.target || evt.srcElement,
			        rect = target.getBoundingClientRect(),
			        offsetX = evt.clientX - rect.left,
			        offsetY = evt.clientY - rect.top;
			    	rx = offsetX - 3,
			    	ry = offsetY - 3;
			    var w = parseFloat(css.currentLayer.css('width')),
			    	h = parseFloat(css.currentLayer.css('height')),
			    	$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER); 
			    $iLayer.css('transform-origin', Math.round(rx/100 * w) + 'px ' + Math.round(ry/100 * h) + 'px');
			    updateHUD(css.currentLayer);
			}
		});
		$('#left_txt').change(function(evt){
			var $this = $(evt.target);
			$('#' + css.currentLayer.attr('id')).css('left', $this.val() + 'px');
		});
		$('#top_txt').change(function(evt){
			var $this = $(evt.target);
			$('#' + css.currentLayer.attr('id')).css('top', $this.val() + 'px');
		});
		$('#w_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			$iLayer.css('width', $this.val() + 'px');
			updateHUD(css.currentLayer);
		});
		$('#h_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			$iLayer.css('height', $this.val() + 'px');
			updateHUD(css.currentLayer);
		});
		$('#bgw_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var sz = $iLayer.css('background-size').split(' ');
			$iLayer.css('background-size', $this.val() + 'px ' + sz[1]);
			updateHUD(css.currentLayer);
		});
		$('#bgh_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var sz = $iLayer.css('background-size').split(' ');
			$iLayer.css('background-size', sz[0] + ' ' + $this.val() + 'px');
			updateHUD(css.currentLayer);
		});
		$('#bgx_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var ps = $iLayer.css('background-position').split(' ');
			$iLayer.css('background-position', $this.val() + 'px ' + ps[1]);
			updateHUD(css.currentLayer);
		});
		$('#bgy_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var ps = $iLayer.css('background-position').split(' ');
			$iLayer.css('background-position', ps[0] + ' ' + $this.val() + 'px');
			updateHUD(css.currentLayer);
		});
		$('#tox_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var to = $iLayer.css('transform-origin').split(' ');
			$iLayer.css('transform-origin', $this.val() + 'px ' + to[1]);
			updateHUD(css.currentLayer);
		});
		$('#toy_txt').change(function(evt){
			var $this = $(evt.target),
				$iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var to = $iLayer.css('transform-origin').split(' ');
			$iLayer.css('transform-origin', to[0] + ' ' + $this.val() + 'px');
			updateHUD(css.currentLayer);
		});
		$('#opacity_rng').change(function(evt){
			var $this = $(evt.target);
			var op = (parseFloat($this.val()) / 100);
			css.currentLayer.find('#' + css.currentLayer.attr('id') + I_LAYER).css('opacity',op);
			updateHUD(css.currentLayer);
		})
		//TRANSFORM
		$('#rot_rng').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.rotate){
				layerTransform.rotate = 0;
			}
			layerTransform.rotate = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#rot_txt').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.rotate){
				layerTransform.rotate = 0;
			}
			layerTransform.rotate = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#sc_rng').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.scale){
				layerTransform.scale = {x:1,y:1};
			}
			layerTransform.scale.x = parseFloat($this.val()) / 100;
			layerTransform.scale.y = parseFloat($this.val()) / 100;
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#sk_rng').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.skew){
				layerTransform.skew = 0;
			}
			layerTransform.skew = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#x_txt').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.translate){
				layerTransform.translate = {x:0,y:0};
			}
			layerTransform.translate.x = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#y_txt').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.translate){
				layerTransform.translate = {x:0,y:0};
			}
			layerTransform.translate.y = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.currentLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#scx_txt').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.scale){
				layerTransform.scale = {x:1,y:1};
			}
			layerTransform.scale.x = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#scy_txt').change(function(evt){
			var $this = $(evt.target);
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			var layerTransform = css.layerTransforms[css.currentLayer.attr('id')];
			if(!layerTransform.scale){
				layerTransform.scale = {x:1,y:1};
			}
			layerTransform.scale.y = parseFloat($this.val());
			$iLayer.css('transform', createTransform(layerTransform));
			$iLayer.css('-webkit-transform', createTransform(layerTransform));
			updateHUD(css.currentLayer);
		});
		$('#scale_txt').change(function(evt){
			var $this = $(evt.target);
			var ratio = parseFloat($this.val())/100;
			var name = css.currentLayer.attr('id');
			css.imgSizes[name].scale = ratio;
			var w = fixDecimal(css.imgSizes[name].width * css.imgSizes[name].scale) + 'px';
			var h = fixDecimal(css.imgSizes[name].height * css.imgSizes[name].scale) + 'px';
			var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
			$iLayer.css('width', w);
			$iLayer.css('height',h);
			$iLayer.css('background-size', w + ' ' + h);
			updateHUD(css.currentLayer);
		});
		$('#align_sl').change(function(evt){
			var val = $(evt.target).val();
			var name = css.currentLayer.attr('id');
			if(val === 'top'){
				css.currentLayer.css('top','0px');
			}
			if(val === 'bottom'){
				css.currentLayer.css('top', (css.container.height - css.imgSizes[name].height) + 'px');
			}
			if(val === 'left'){
				css.currentLayer.css('left','0px');
			}
			if(val === 'right'){
				css.currentLayer.css('left', (css.container.width - css.imgSizes[name].width) + 'px');
			}
			if(val === 'center'){
				css.currentLayer.css('left', Math.round((css.container.width - css.imgSizes[name].width)/2) + 'px');
			}
			if(val === 'middle'){
				css.currentLayer.css('top', Math.round((css.container.height - css.imgSizes[name].height)/2) + 'px');
			}
			updateHUD(css.currentLayer);
		});
		$(document).keyup(function(evt){
			evt.stopPropagation();
			evt.stopImmediatePropagation();
    		evt.preventDefault();
			if(evt.which > 36 && evt.which < 41){
				css.currentLayer.focus();
				var top = parseFloat(css.currentLayer.css('top'));
				var left = parseFloat(css.currentLayer.css('left'));
				top = isNaN(top)?0:top;
				left = isNaN(left)?0:left;
				var step = (evt.shiftKey) ? 10 : 1;
				var name = css.currentLayer.attr('id');
				var layerTransform = css.layerTransforms[name];
				var $iLayer = $('#' + name + I_LAYER);
				if(evt.altKey){
					switch(evt.which){
						case 38:
							if(!layerTransform.scale){
								layerTransform.scale = {x:1,y:1}
							}
							step = (evt.shiftKey) ? 0.5 : 0.1;
							layerTransform.scale.x += step;
							layerTransform.scale.y += step;
						break;
						case 40:
							if(!layerTransform.scale){
								layerTransform.scale = {x:1,y:1}
							}
							step = (evt.shiftKey) ? 0.5 : 0.1;
							layerTransform.scale.x -= step;
							layerTransform.scale.y -= step;
						break;
						case 37:
							if(!layerTransform.rotate){
								layerTransform.rotate = 0
							}
							layerTransform.rotate -= step;
							layerTransform.rotate -= step;
						break;
						case 39:
							if(!layerTransform.rotate){
								layerTransform.rotate = 0
							}
							layerTransform.rotate += step;
							layerTransform.rotate += step;
						break;
					}
					$iLayer.css('transform', createTransform(layerTransform));
					$iLayer.css('-webkit-transform', createTransform(layerTransform));
				}else{
					switch(evt.which){
						case 38:
							css.currentLayer.css('top', (top + (step * -1)) + 'px' );
						break;
						case 40:
							css.currentLayer.css('top', (top + step) + 'px' );
						break;
						case 37:
							css.currentLayer.css('left', (left + (step * -1)) + 'px' );
						break;
						case 39:
							css.currentLayer.css('left', (left + step) + 'px' );
						break;
					}					
				}
				updateHUD(css.currentLayer);
			}
			return false;
		});/**/
		$('#reset_btn').click(function(evt){
			var name = css.currentLayer.attr('id');
			var layerTransform = css.layerTransforms[name];
			var $iLayer = $('#' + name + I_LAYER);
			layerTransform = {};
			$iLayer.css('transform','none');
			$iLayer.css('-webkit-transform','none');
			//$iLayer.css('opacity','1');
			updateHUD(css.currentLayer);
			evt.preventDefault();
			evt.stopPropagation();
		});
		$('#htmlOutput').click(function(evt){
			$(this).select();
		})
	}
  	function createTransform(o){
		var s = '';
			if('translate' in o || 'translateX' in o || 'translateY' in o || 'translateZ' in o || 'rotate' in o || 'skew' in o || 'scale' in o || 'scaleX' in o || 'scaleY' in o || 'perspective' in o || 'scale3d' in o || 'translate3d' in o || 'rotate3d' in o || 'rotateX' in o || 'rotateY' in o || 'rotateZ' in o){
				if('perspective' in o){
					s += o['perspective'];
				}
				if('translate3d' in o){
					s += o['translate3d'];
				}
				if('scale3d' in o){
					s += o['scale3d'];
				}
				if('rotate3d' in o){
					s += o['rotate3d'];
				}
				if('rotateX' in o){
					s += 'rotateX(' + o['rotateX'] + ') ';
				}
				if('rotateY' in o){
					s += 'rotateY(' + o['rotateY']+ ') ';
				}
				if('rotateZ' in o){
					s += 'rotateZ(' + o['rotateZ']+ ') ';
				}
				if('translateZ' in o){
					s += o['translateZ'];
				}
				if('translateX' in o && 'translateY' in o){
					s += 'translate('+ o['translateX'] + 'px, ' + o['translateY'] + 'px) ' ;
				}else{
					if('translateX' in o){
						s += 'translateX(' + o['translateX'] + ') ' ;
					}
					if('translateY' in o){
						s += 'translateY(' + o['translateY'] + ') ';
					}				
				}
				if('translate' in o){
					s += 'translate(' + o['translate']['x'] + 'px,' + o['translate']['y'] + 'px) ';
				}
				if('scaleX' in o){
					s += o['scaleX'];
				}
				if('scaleY' in o){
					s += o['scaleY'];
				}
				if('scale' in o){
					s += 'scale('+o['scale']['x']+','+o['scale']['y']+') ';
				}
				if('rotate' in o){
					s += 'rotate('+ o['rotate'] +'deg) ';
				}
				if('skew' in o){
					s += 'skew('+ o['skew'] +'deg) ';
				}
			}
		return s;
	}
	function createHTML(){
		var onlycss = $('#onlycss_ck').prop('checked');
		var s = '',
			_n = '\n',
			_t = '\t';
		if(!onlycss){
			s += '<!DOCTYPE html>' + _n;
			s += '<html lang="en">' + _n;
			s += '<head>' + _n;
			s += '<meta charset="UTF-8">' + _n;
			s += '<title>Document</title>' + _n;
			s += '<style type="text/css">' + _n;	
		}

		s += createCSS();

		if(!onlycss){
			s += '</style>' + _n;
			s += '</head>' + _n;
			s += '<body>' + _n;
			s += '<div class="banner">' + _n;
			for(var i = 0; i < css.layers.length; i++){
				s += _t + '<div class="' + $(css.layers[i]).attr('id') + '"></div>' + _n;
			}
			s += '</div>' + _n;
			s += '</body>' + _n;
			s += '</html>' + _n;			
		}

		return s;
	}
	function getScale(transform){
		var matrixArr = transform.replace('matrix(', '').replace(')', '').split(',');
		return {x: parseFloat(matrixArr[0]), y: parseFloat(matrixArr[3])};
	}
	function getElementClass($layer, tCSS){
		//tCSS is for use in tranCiSSioner
		var s = '',
			_n = '\n',
			_t = '\t';
			var name = $layer.attr('id');
			var $oLayer = $('#' + name + O_LAYER);
			var $iLayer = $('#' + name + I_LAYER);
			var transform = $iLayer.css('transform') || $iLayer.css('-webkit-transform');
			var to = $iLayer.css('transform-origin') || $iLayer.css('-webkit-transform-origin');
			s += '.' + name + '{' + _n;
			s += _t + 'display: block;' + _n;
			s += _t + 'position: absolute;' + _n;
			s += _t + 'opacity: ' + (tCSS?'@OPACITY@':fixDecimal(parseFloat($iLayer.css('opacity')))) + ';' + _n;
			s += _t + 'left: ' + (tCSS?'@LEFT@':$layer.css('left')) + ';' + _n;
			s += _t + 'top: ' + (tCSS?'@TOP@':$layer.css('top')) + ';' + _n;
			s += _t + 'width: ' + $iLayer.css('width') + ';' + _n;
			s += _t + 'height: ' + $iLayer.css('height') + ';' + _n;
			s += _t + 'background-image: url('+ css.images[name] + ');' + _n;
			s += _t + 'background-repeat: no-repeat;' + _n;
			s += _t + 'background-position: ' + $iLayer.css('background-position') + ';' + _n;
			s += _t + 'background-size: ' + $iLayer.css('background-size')+ ';' + _n;
			if(transform != 'none'){
				s += _t + 'transform: ' + transform + ';' + _n;
				s += _t + '-webkit-transform: ' + transform + ';' + _n;
			}
			s += _t + 'transform-origin: ' + to + ';' + _n;
			s += _t + '-webkit-transform-origin: ' + to + ';' + _n;
			s += (tCSS)?_t + 'will-change: @WILL_CHANGE@;' + _n:'';
			s += '}' + _n;		
		return s;
	}
	function createCSS(){
		var s = '',
			_n = '\n',
			_t = '\t';
		
		for(var i = 0; i < css.layers.length; i++){
			s += getElementClass($(css.layers[i]));
		}
		s += '.banner {' + _n;
		s += _t + 'display: block;' + _n;
		s += _t + 'position: absolute;' + _n;
		s += _t + 'overflow: hidden;' + _n;
		s += _t + 'width: ' + (css.container.width - 2) + 'px;' + _n;
		s += _t + 'height: ' + (css.container.height -2) + 'px;' + _n;
		s += _t + 'background-color: ' + css.container.bgColor + ';' + _n;
		if(css.background.file){
			s += _t + 'background-image: url(' + css.background.file.name + ');' + _n;
			s += _t + 'background-repeat: no-repeat;' + _n;
		}
		s += _t + 'border: 1px solid '+css.container.borderColor+';' + _n;
		s += _t + 'transform-style: preserve-3d;' + _n;
		s += _t + '-webkit-transform-style: preserve-3d;' + _n;
		s += '}' + _n;	
		return s;	
	}
	//EVENTS
	$guide_fl.change(function(evt){
		css.background.file = evt.target.files[0];
		if (css.background.file.type.match(/image.*/)){
			var reader = new FileReader();
			reader.onload = function(evt){
				var img = new Image();
				img.src = reader.result;
				changeSize(img.width,img.height);
				delete img;
				$stage.css('background-image', 'url(' + reader.result + ')');
			}
			reader.readAsDataURL(css.background.file);
		}
	});
	$size_sl.change(function(evt){
		evt.stopPropagation();
		evt.preventDefault();
		var raw = $(evt.target).val().split('x');
		changeSize(raw[0],raw[1]);
	});
	$width_txt.change(function(evt){
		evt.stopPropagation();
		evt.preventDefault();
		changeSize($width_txt.val(),$height_txt.val());
		return false;
	});
	$height_txt.change(function(evt){
		evt.stopPropagation();
		evt.preventDefault();
		changeSize($width_txt.val(),$height_txt.val());
		return false;
	});
	$('#bgColor_txt, #borderColor_txt').change(function(evt){
		evt.stopPropagation();
		evt.preventDefault();
		changeColors($('#bgColor_txt').val(), $('#borderColor_txt').val());
		return false;
	});
	$('#overflow_ck').change(function(evt){
		$stage.toggleClass('hideOverflow');
	});
	function onDragStart(evt){
		var layer = getLayer(evt.target.id);
		if(layer === this){
			selectLayer(layer);
		}
	}
	function onDragStop(evt){
		var layer = getLayer(evt.target.id);
		updateHUD($(layer));
	}
	function handleFileSelect(evt) {
    	evt.stopPropagation();
    	evt.preventDefault();
    	createLayer(evt.dataTransfer.files)
	}
	function handleDragOver(evt){
		evt.stopPropagation();
    	evt.preventDefault();
    	evt.dataTransfer.dropEffect = 'copy';
	}
	$id('stage').addEventListener('dragover', handleDragOver, false);
  	$id('stage').addEventListener('drop', handleFileSelect, false);
  	//tranCiSSioner
  	var currentTranCiSSioner = {target:null,name:'',x:0,y:0,css:''};
  	$('#trancissioner_btn').click(function(evt){
  		currentTranCiSSioner = {
  			target:css.currentLayer,
  			name:css.currentLayer.attr('id'),
  			x:parseFloat(css.currentLayer.css('left')),
  			y:parseFloat(css.currentLayer.css('top')),
  			css:getElementClass(css.currentLayer,true)
  		};
  		$('#scene_element_txt').val(currentTranCiSSioner.name);
  		$('#left_scene_txt').val(currentTranCiSSioner.x);
  		$('#top_scene_txt').val(currentTranCiSSioner.y);
  		$('.tranCiSSioner_tools').show();
  		$('.overlay').show();
  	});
  	$('#tranCiSSioner_close').click(function(evt){
  		$('.overlay').hide();
  		$('.tranCiSSioner_tools').hide();
  	});
  	function sideMap(side, offset){
  		var map = {
			'tl' : {x:-offset, y:-offset},
			'top': {x:0, y:-offset},
			'tr' : {x:offset, y:-offset},
			'left': {x:-offset, y:0},
			'none': {x:0, y:0},
			'right': {x:offset, y:0},
			'bl': {x:-offset, y:offset},
			'bottom': {x:0, y:offset},
			'br': {x:0, y:offset}		
  		};
  		return map[side];
  	}
  	$('#scene_element_txt').change(function(evt){
  		var nn = $(evt.target).val();
  		currentTranCiSSioner.css = currentTranCiSSioner.css.replace('.' + currentTranCiSSioner.name, '.' + nn);
  		currentTranCiSSioner.name = nn;
  	});
  	$('#tranCiSSioner_create_btn').click(function(evt){
  		/* tranCiSSioner MAGIC */
  		var s = '',
			_n = '\n',
			_t = '\t';
		/* RESTING POSITION */
		var offsetIn = parseFloat($('#offset_in_txt').val());
		var sideIn = $("input:radio[name=scene_in_rb]:checked").val();
		var sideOut = $("input:radio[name=scene_out_rb]:checked").val();
		var transformIn = $('#matrix_in_txt').val();
		var transformOut = $('#matrix_out_txt').val();
		var willChange = {'opacity':true, 'left': false, 'top': false, 'transform': false};
		var sm = sideMap(sideIn, offsetIn);
		var sceneIn = $('#scene_in_txt').val();
		var x1 = 0, y1 = 0, o1 = 0;
		x1 = (currentTranCiSSioner.x + sm.x) + 'px';
		y1 = (currentTranCiSSioner.y + sm.y) + 'px';
		o1 = parseFloat($('#opacity_in_txt').val()) + '';
		s += '/* LAYER: ' + currentTranCiSSioner.name + ' PROPERTIES */' + _n;
		var tempIn = currentTranCiSSioner.css;
		tempIn = tempIn.replace('@OPACITY@', o1);
		tempIn = tempIn.replace('@LEFT@', x1);
		tempIn = tempIn.replace('@TOP@', y1);
		//will-change
		var willChangeArr = ['opacity'];
		if(sideIn == 'tl' || sideIn == 'tr' || sideIn == 'bl' || sideIn == 'br' || sideOut == 'tl' || sideOut == 'tr' || sideOut == 'bl' || sideOut == 'br'){
			willChangeArr.push('left','top');
		}
		if(sideIn == 'top' || sideIn == 'bottom' || sideOut == 'top' || sideOut == 'bottom'){
			willChangeArr.push('top');
		}
		if(sideIn == 'left' || sideIn == 'right' || sideOut == 'left' || sideOut == 'right'){
			willChangeArr.push('left');
		}
		if(transformIn != '' || transformOut != ''){
			willChangeArr.push('transform');
		}
		tempIn = tempIn.replace('@WILL_CHANGE@', willChangeArr.join(', '));
		s += tempIn;
		/* SCENE IN */
		s += '/* scene '+ sceneIn + ' ' + currentTranCiSSioner.name + ' APPEARS */' + _n;
		willChange = {'opacity':true, 'left': false, 'top': false};
		if(sideIn == 'tl' || sideIn == 'tr' || sideIn == 'bl' || sideIn == 'br'){
			willChange.left = true;
			willChange.top = true;
		}else if(sideIn == 'top' || sideIn == 'bottom'){
			willChange.top = true;
		}else if(sideIn == 'left' || sideIn == 'right'){
			willChange.left = true;
		}
		if(transformIn != ''){
			willChange.transform = true;
		}
		s += '.scene' + sceneIn  + ' .'+ currentTranCiSSioner.name + '{' + _n;
		var transIn = [];
		if(willChange.opacity){
			s += _t + 'opacity: 1;' + _n;
			transIn.push('opacity ' + $('#duration_in_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_in_txt').val()+ 's') ;
		}
		if(willChange.left){
			s += _t + 'left: ' + $('#left_scene_txt').val() + 'px;' + _n;
			transIn.push('left ' + $('#duration_in_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_in_txt').val() + 's');
		}
		if(willChange.top){
			s += _t + 'top: ' + $('#top_scene_txt').val() + 'px;' + _n;
			transIn.push('top ' + $('#duration_in_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_in_txt').val() + 's');
		}
		if(willChange.transform){
			s += _t + 'transform: ' + transformIn + ';' + _n;
			s += _t + '-webkit-transform: ' + transformIn + ';' + _n;
			transIn.push ('transform ' + $('#duration_in_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_in_txt').val() + 's');
			transIn.push ('-webkit-transform ' + $('#duration_in_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_in_txt').val() + 's');
		}
		s += _t + 'transition: ' + transIn.join(', ') + ';' + _n;
		s += _t + '-webkit-transition: ' + transIn.join(', ') + ';' + _n;
		s += '}' + _n; 
		/* SCENE OUT */
		var offsetOut = parseFloat($('#offset_out_txt').val());
		sm = sideMap(sideOut, offsetOut);
		var sceneOut = $('#scene_out_txt').val();
		var x2 = 0, y2 = 0, o2 = 0;
		x2 = (currentTranCiSSioner.x + sm.x) + 'px';
		y2 = (currentTranCiSSioner.y + sm.y) + 'px';
		o2 = parseFloat($('#opacity_out_txt').val()) + '';
		s += '/* scene '+ sceneOut + ' ' + currentTranCiSSioner.name + ' DISAPPEARS */' + _n;
		s += '.scene' + sceneOut + ' .'+ currentTranCiSSioner.name +'{' + _n;
		willChange = {'opacity':true, 'left': false, 'top': false};
		if(sideOut == 'tl' || sideOut == 'tr' || sideOut == 'bl' || sideOut == 'br'){
			willChange.left = true;
			willChange.top = true;
		}else if(sideOut == 'top' || sideOut == 'bottom'){
			willChange.top = true;
		}else if(sideOut == 'left' || sideOut == 'right'){
			willChange.left = true;
		}
		if(transformOut != ''){
			willChange.transform = true;
		}
		var transOut = [];
		if(willChange.opacity){
			s += _t + 'opacity: '+ o2 + ';' + _n;
			transOut.push('opacity ' + $('#duration_out_txt').val() + 's' + ' ' + $('#ease_out_sl').val() + ' ' + $('#delay_out_txt').val() + 's');
		}
		if(willChange.left){
			s += _t + 'left: ' + x2 + ';'  + _n;
			transOut.push('left ' + $('#duration_out_txt').val() + 's' + ' ' + $('#ease_out_sl').val() + ' ' + $('#delay_out_txt').val() + 's');
		}
		if(willChange.top){
			s += _t + 'top: ' + y2 + ';' + _n;
			transOut.push('top ' + $('#duration_out_txt').val() + 's' + ' ' + $('#ease_in_sl').val() + ' ' + $('#delay_out_txt').val() + 's');
		}
		if(willChange.transform){
			s += _t + 'transform: ' + transformOut + ';' + _n;
			s += _t + '-webkit-transform: ' + transformOut + ';' + _n;
			transOut.push ('transform ' + $('#duration_out_txt').val() + 's' + ' ' + $('#ease_out_sl').val() + ' ' + $('#delay_out_txt').val() + 's');
			transOut.push ('-webkit-transform ' + $('#duration_out_txt').val() + 's' + ' ' + $('#ease_out_sl').val() + ' ' + $('#delay_out_txt').val() + 's');
		}
		s += _t + 'transition: ' + transOut.join(', ') + ';' + _n;
		s += _t + '-webkit-transition: ' + transOut.join(', ') + ';' + _n;
		s += '}' + _n; 
		//fill
		$('#transition_css_txt').val(s);
		$('#transition_css_txt').select();
		return s;
  	});
//Sprite Slicer
var $guide = $('.ss_guide'), $ss_container = $('.ss_container'), $ss_image = $('.ss_image'), $cuts = $('#ss_cuts_txt');
var currentSpriteSlice = {target:null,name:'', x:0, y:0, width:0, height:0, css:''};
$('#spriteslicer_btn').click(function(evt){
	//$cuts.val('');
	var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
	currentSpriteSlice = {
		target:css.currentLayer,
  		name:css.currentLayer.attr('id'),
  		x:parseFloat(css.currentLayer.css('left')),
  		y:parseFloat(css.currentLayer.css('top')),
  		width:parseFloat($iLayer.css('width')),
  		height:parseFloat($iLayer.css('height')),
  		image: $iLayer.css('background-image'),
  		bgSize: $iLayer.css('background-size')
	};
	$ss_container.css('width', currentSpriteSlice.width + 'px');
	$ss_container.css('height', currentSpriteSlice.height + 'px');
	$ss_image.css('background-image', currentSpriteSlice.image);
	$ss_image.css('width', currentSpriteSlice.width + 'px');
	$ss_image.css('height', currentSpriteSlice.height + 'px');
	$ss_image.css('background-repeat', 'no-repeat');
	$ss_image.css('background-size', currentSpriteSlice.bgSize);
	$('.spriteSlicer_tools').show();
  	$('.overlay').show();
});
$('#spriteSlicer_close').click(function(evt){
  	$('.overlay').hide();
  	$('.spriteSlicer_tools').hide();
});
//follow mouse
$ss_container.on('mousemove', function(evt){
	var posY = Math.round(evt.pageY - $ss_container.offset().top);
	$guide.text('y: ' + posY + 'px')
	$guide.css('top', posY + 'px');
});
$ss_container.on('click', function(evt){
	var posY = Math.round(evt.pageY - $ss_container.offset().top);
	var cuts = $cuts.val() + posY + ',';
	$cuts.val(cuts);
});
var currentSlices;
var $applyButton = $('#ss_apply');
var $slices = $('#ss_slices');
$('#spriteSplicer_create_btn').click(function(evt){
	var layered = $('#ss_layered_ck').prop('checked');
	var transition = $('#ss_transition_ck').prop('checked');
	var sceneIn = $('#ss_scene_in_txt').val();
	var sceneOut = $('#ss_scene_out_txt').val();
	var staggerIn = parseFloat($('#ss_delay_in').val());
	var staggerOut = parseFloat($('#ss_delay_out').val());
	var cuts_arr = $cuts.val().split(',');
	cuts_arr[cuts_arr.length - 1] = currentSpriteSlice.height;
	var s = '',
			_n = '\n',
			_t = '\t';
	var pos = currentSpriteSlice.y;
	var height = 0;
	var offset = 0;
	var last = cuts_arr.length;
	currentSlices = []
	for(var i=0; i < cuts_arr.length; i++){
		var slice = {top:0,height:0,backgroundPositionY:0};
		var val = parseInt(cuts_arr[i]);
		var name = currentSpriteSlice.name + ( i + 1 );
		height = (i != 0)?(val - parseInt(cuts_arr[i-1])): val;
		s += '/* LAYER: ' + name + ' PROPERTIES */' + _n;
		s += '.' + name + '{' + _n;
		s += _t + 'display: block;' + _n;
		s += _t + 'position: absolute;' + _n;
		if(transition){
			s += _t + 'opacity: 0;' + _n;
		}else{
			s += _t + 'opacity: 1;' + _n;
		}
		s += _t + 'left: ' + currentSpriteSlice.x + 'px;' + _n;
		slice.top = pos;
		s += _t + 'top: ' + pos + 'px;' + _n;
		pos += (layered)?0:height;
		s += _t + 'width: ' + currentSpriteSlice.width + 'px;' + _n;
		slice.height = height;
		s += _t + 'height: ' + height + 'px;' + _n;
		s += _t + 'background-image: url('+ css.images[currentSpriteSlice.name] + ');' + _n;
		s += _t + 'background-repeat: no-repeat;' + _n;
		slice.backgroundPositionY = offset * -1;
		s += _t + 'background-position: 0px ' + (offset * -1) + 'px;' + _n;
		offset = val;
		s += _t + 'background-size: ' + currentSpriteSlice.bgSize + ';' + _n;
		s += '}' + _n;
		if(transition){
			s += '/* scene ' + sceneIn + ' ' + name + ' APPEARS */' + _n;
			s += '.scene' + sceneIn + ' .' + name + '{' + _n;
			s += _t + 'opacity: 1;' + _n;
			var trans = 'transition: opacity 0.5s ease-out ' + ((i + 1) * staggerIn) + 's;' + _n;
			s += _t + trans;
			s += _t + '-webkit-' + trans;
			s += '}' + _n;
			s += '/* scene ' + sceneOut + ' ' + name + ' DISAPPEARS */' + _n;
			s += '.scene' + sceneOut + ' .' + currentSpriteSlice.name + ( i + 1 ) + '{' + _n;
			s += _t + 'opacity: 0;' + _n;
			trans = 'transition: opacity 0.3s ease-in ' + (Math.round(((i + 1) * staggerOut)*100)/100) + 's;' + _n;
			s += _t + trans;
			s += _t + '-webkit-' + trans;
			s += '}' + _n;
		}
		currentSlices.push(slice);
	}
	$slices.attr('max', currentSlices.length);
	$('#ss_code_txt').val(s).select();
});
$applyButton.click(function(evt){
	var $iLayer = $('#' + css.currentLayer.attr('id') + I_LAYER);
	var slice = currentSlices[parseInt($slices.val()) - 1];
	$iLayer.css('background-position', '0px ' + slice.backgroundPositionY + 'px');
	$iLayer.css('height', slice.height + 'px');
	$('#' + css.currentLayer.attr('id')).css('top', slice.top + 'px');
	updateHUD(css.currentLayer);
	$('.overlay').hide();
  	$('.spriteSlicer_tools').hide();
});
$('#ss_reset').click(function(evt){
	$cuts.val('');
});
	//init
	onHUDEvents();
});
</script>
</body>
</html>
